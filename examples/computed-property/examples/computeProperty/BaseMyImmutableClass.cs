// Automatically generated by Model#
// DO NOT EDIT THIS FILE

using System.Collections.ObjectModel;
using System.Collections.Generic;
using System.Runtime.Serialization;
using System.Diagnostics;
using System;

namespace examples.computeProperty
{

	[DataContract]
	[DebuggerDisplay("MyImmutableClass[X={X} Y={Y} Children={Children.Count}items]")]
	public abstract class BaseMyImmutableClass : ICloneable
	{
		[DataMember(Name = "X", Order = 0, IsRequired = false)]
		public readonly double X;
		
		[DataMember(Name = "Y", Order = 1, IsRequired = false)]
		public readonly double Y;
		
		[DataMember(Name = "Children", Order = 2, IsRequired = false)]
		public readonly ReadOnlyCollection<MyClass> Children;
		
		public BaseMyImmutableClass(double x, double y, IEnumerable<MyClass> children)
		{
			X = x;
			Y = y;
			squaredLengthCachedCacheValid = false;
			Children = new ReadOnlyCollection<MyClass>(new List<MyClass>(children));
		}
		
		public BaseMyImmutableClass(BaseMyImmutableClass other)
		{
			this.X = other.X;
			this.Y = other.Y;
			squaredLengthCachedCacheValid = false;
			var children = new List<MyClass>();
			children.AddRange(other.Children);
			Children = new ReadOnlyCollection<MyClass>(children);
		}
		
		public virtual MyImmutableClass WithX(double x)
		{
			return new MyImmutableClass(x, Y, Children);
		}
		
		public virtual MyImmutableClass WithY(double y)
		{
			return new MyImmutableClass(X, y, Children);
		}
		
		public double Length
		{
			[DebuggerStepThrough]
			get {
				return ComputeLength();
			}
		}
		
		protected virtual double ComputeLength()
		{
			return Math.Sqrt(X * X + Y * Y);
		}
		
		public string Dummy
		{
			[DebuggerStepThrough]
			get {
				return ComputeDummy();
			}
		}
		
		protected abstract string ComputeDummy();
		
		public double SquaredLength
		{
			[DebuggerStepThrough]
			get {
				return ComputeSquaredLength();
			}
		}
		
		protected abstract double ComputeSquaredLength();
		
		[DebuggerBrowsable(DebuggerBrowsableState.Never)]
		private double squaredLengthCachedCache;
		[DebuggerBrowsable(DebuggerBrowsableState.Never)]
		private bool squaredLengthCachedCacheValid;
		
		public double SquaredLengthCached
		{
			[DebuggerStepThrough]
			get {
				return ComputeAndCacheSquaredLengthCached();
			}
		}
		
		protected virtual void InvalidateSquaredLengthCachedCache()
		{
			squaredLengthCachedCacheValid = false;
		}
		
		private double ComputeAndCacheSquaredLengthCached()
		{
			if (!squaredLengthCachedCacheValid)
			{
				this.squaredLengthCachedCache = ComputeSquaredLengthCached();
				this.squaredLengthCachedCacheValid = true;
			}
			
			return this.squaredLengthCachedCache;
		}
		
		protected abstract double ComputeSquaredLengthCached();
		
#pragma warning disable 109
		public new MyImmutableClass Clone()
#pragma warning restore 109
		{
			return (MyImmutableClass) ((ICloneable) this).Clone();
		}
		
		object ICloneable.Clone()
		{
			return new MyImmutableClass((MyImmutableClass) this);
		}
	}
	
}
